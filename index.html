<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Juzgómetro</title>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      position: relative;
      min-height: 100vh;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('fondo.png');
      background-repeat: repeat;
      background-size: auto;
      opacity: 0.5;
      z-index: -1;
    }

    #juzgometro {
      background: #1f4aa3;
      padding: 1rem;
      border-radius: 12px;
      max-width: 400px;
      margin: 1rem auto;
    }

    h1 {
      color: white;
      text-align: center;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .nivel {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      min-height: 50px;
      flex-wrap: wrap;
    }

    .titulo-nivel {
      flex: 1 1 45%;
      font-weight: bold;
      color: white;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .dropzone {
      flex: 1 1 50%;
      min-height: 40px;
      background: white;
      border-radius: 6px;
      padding: 4px;
      font-size: 0.85rem;
      text-align: center;
    }

    .dropzone.ocupado {
      background-color: #ccc;
      pointer-events: none;
    }

    .situacion {
      background: black;
      color: white;
      padding: 8px;
      border-radius: 6px;
      font-size: 1rem;
      cursor: move;
      margin: 10px auto;
      width: 90%;
      text-align: center;
      user-select: none;
      touch-action: none;
    }

    .botones {
      margin: 1rem auto 2rem;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      max-width: 400px;
    }

    button {
      padding: 10px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #1f4aa3;
      color: white;
      min-width: 140px;
      flex: 1 1 45%;
      max-width: 180px;
    }

    .btn-juzgar {
      background: linear-gradient(45deg, #0026ff, #1fffe1, #2986ff);
      background-size: 200% 200%;
      animation: gradientShift 3s ease infinite;
      color: #fff;
      font-weight: bold;
      font-size: 1.1rem;
      padding: 14px;
      border-radius: 12px;
      box-shadow: 0 0 10px #000000, 0 0 15px #ff0044;
      flex: 1 1 100%;
      max-width: 100%;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @media (max-width: 480px) {
      .titulo-nivel { font-size: 1rem; }
      .dropzone { font-size: 1rem; min-height: 50px; }
      .situacion { font-size: 1.1rem; }
      button { font-size: 1.1rem; }
    }
  </style>
</head>
<body>

  <div id="juzgometro">
    <h1>JUZGÓMETRO</h1>
    <div class="nivel" style="background:#e53935"><div class="titulo-nivel">ARDERÁS EN EL INFIERNO</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#fb8c00"><div class="titulo-nivel">A LA GUILLOTINA</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#fdd835; color:#000"><div class="titulo-nivel">MARCHE PRESO</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#66bb6a"><div class="titulo-nivel">VA A PROBATION</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#29b6f6"><div class="titulo-nivel">OJOS QUE NO VEN</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#ab47bc"><div class="titulo-nivel">PEQUEÑO DESLIZ</div><div class="dropzone"></div></div>
    <div class="nivel" style="background:#ff17a6"><div class="titulo-nivel">QUIEN ESTÉ LIBRE DE PECADO...</div><div class="dropzone"></div></div>
  </div>

  <div id="contenedor-situaciones"></div>

  <div class="botones">
    <button id="btnAgregar" class="btn-juzgar" onclick="agregarSituacion()">Argentinos... a juzgar</button>
    <button onclick="descargarImagen()">Descargar</button>
    <button onclick="reiniciar()">Reiniciar</button>
    <button onclick="window.location.href='agrega.html'">Agregar situaciones</button>
  </div>

  <script>
    const todasLasSituaciones = [
  "en pandemia vendí cigarrillos al doble",
  "metí rapidito en un velorio",
  "choqué un auto estacionado y me fui",
  "mentí con una muerte",
  "veo a mi amante en frente de mi pareja",
  "tire las cenizas de mi abuelo y las reemplace por tierra",
  "buchonee a mi amiga con su infidelidad",
  "un amigo chocó, lo vi y seguí de largo",
  "no fui al velorio de la mamá de mi amiga",
  "garché con un diácono",
  "vomité al chico con el que salgo en la segunda cita",
  "cobré mucho por un trabajo y lo hice todo con ChatGPT",
  "critiqué de pe a pa la boda de mi mejor amiga",
  "estuve con la ex esposa de un compañero de fútbol",
  "hago resúmenes erróneos y se los doy a mis compañeros",
  "exprimí una rejilla sucia en el café de una compañera",
  "tengo 45 años y me como los mocos",
  "me hice una cuenta fake, invito a mis exs a citas y no voy",
  "manché un pantalón de mi novio y no le dije",
  "usé las millas de mi ex para comprarle un pasaje a mi actual",
  "estoy embarazada y me cojo a mi jefe",
  "tengo un Excel con las personas que empezaron a seguir a mi ex",
  "mi jefa no me pagó el aguinaldo y le robé",
  "mi prima cortó con su novio porque le hice imágenes de falsa infidelidad con IA",
  "le mentí a la pareja de mi amiga para pasar yo al parto",
  "cuando mi marido tarda mucho en la ducha abro la canilla de agua fría en la cocina",
  "me robaron al perro, encontré uno igual y me lo quedé",
  "limpié el inodoro con el cepillo de dientes de mi novio porque me engañó",
  "me hicieron sexo oral en el auto y también iban mis padres en ese auto",
  "le mentí a mi amiga para que no entre al laburo",
  "le metí sal al polvito dietético de la novia de mi papá",
  "me quedé con 7 millones de mi viejo de querusa",
  "me cojo al hermano de mi novio y solo uno lo sabe",
  "toco saleritos ajenos en el colectivo",
  "le pinchaba forros a mi mamá para tener un hermanito"
];


    let situaciones = [...todasLasSituaciones];
    const situacionesContenedor = document.getElementById('contenedor-situaciones');
    const dropzones = document.querySelectorAll('.dropzone');

    function agregarSituacion() {
      if (situaciones.length === 0) {
        alert("Ya no quedan más situaciones.");
        return;
      }

      if (document.querySelector('.situacion')) {
        alert("Primero tenés que juzgar la situación actual.");
        return;
      }

      const btn = document.getElementById('btnAgregar');
      btn.disabled = true;

      const indice = Math.floor(Math.random() * situaciones.length);
      const texto = situaciones.splice(indice, 1)[0];

      const el = document.createElement('div');
      el.className = 'situacion';
      el.textContent = texto;

      el.draggable = true;
      el.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', el.textContent);
        setTimeout(() => el.remove(), 0);
      });

      let offsetX, offsetY;
      let currentDropzone = null;

      el.addEventListener('touchstart', (e) => {
        const touch = e.touches[0];
        const rect = el.getBoundingClientRect();
        offsetX = touch.clientX - rect.left;
        offsetY = touch.clientY - rect.top;
        el.style.position = 'fixed';
        el.style.left = `${touch.clientX - offsetX}px`;
        el.style.top = `${touch.clientY - offsetY}px`;
        el.style.zIndex = 10000;
        e.preventDefault();
      }, { passive: false });

      el.addEventListener('touchmove', (e) => {
        const touch = e.touches[0];
        el.style.left = `${touch.clientX - offsetX}px`;
        el.style.top = `${touch.clientY - offsetY}px`;
        currentDropzone = null;
        dropzones.forEach(zone => {
          const zoneRect = zone.getBoundingClientRect();
          if (
            !zone.classList.contains('ocupado') &&
            touch.clientX > zoneRect.left && touch.clientX < zoneRect.right &&
            touch.clientY > zoneRect.top && touch.clientY < zoneRect.bottom
          ) {
            currentDropzone = zone;
            zone.style.outline = "3px dashed #1f4aa3";
          } else {
            zone.style.outline = "none";
          }
        });
        e.preventDefault();
      }, { passive: false });

      el.addEventListener('touchend', (e) => {
        el.style.position = 'relative';
        el.style.left = '0';
        el.style.top = '0';
        el.style.zIndex = 'auto';
        if (currentDropzone) {
          currentDropzone.textContent = el.textContent;
          currentDropzone.classList.add('ocupado');
          currentDropzone.style.outline = "none";
          el.remove();
          document.getElementById('btnAgregar').disabled = false;
        }
        e.preventDefault();
      }, { passive: false });

      situacionesContenedor.appendChild(el);
    }

    dropzones.forEach(zone => {
      zone.addEventListener('dragover', e => {
        if (!zone.classList.contains('ocupado')) e.preventDefault();
      });

      zone.addEventListener('drop', e => {
        e.preventDefault();
        if (zone.classList.contains('ocupado')) {
          alert("Esa categoría ya fue usada.");
          return;
        }
        const data = e.dataTransfer.getData('text/plain');
        zone.textContent = data;
        zone.classList.add('ocupado');
        document.getElementById('btnAgregar').disabled = false;
      });
    });

    function descargarImagen() {
      html2canvas(document.querySelector("#juzgometro")).then(canvas => {
        const a = document.createElement("a");
        a.href = canvas.toDataURL("image/png");
        a.download = "juzgometro.png";
        a.click();
      });
    }

    function reiniciar() {
      document.querySelectorAll(".dropzone").forEach(z => {
        z.innerHTML = '';
        z.classList.remove('ocupado');
      });
      document.querySelectorAll(".situacion").forEach(s => s.remove());
      situaciones = [...todasLasSituaciones];
      document.getElementById('btnAgregar').disabled = false;
    }
  </script>
</body>
</html>
